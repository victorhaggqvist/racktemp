var RackTemp=function(){"use strict";function a(){var a=new Date,c=a.getHours(),d=a.getMinutes();c=b(c),d=b(d),document.getElementById("clock").innerHTML=c+":"+d}function b(a){return 10>a&&(a="0"+a),a}var c,d,e,f=function(){var a={data:{columns:[],type:"spline",x:"x"}},b={bindto:"#today",data:a.data,axis:{x:{type:"timeseries",tick:{format:"%M"}}},tooltip:{format:{title:function(a){return f(a)}}}},c={bindto:"#today",data:a.data,axis:{x:{label:"Hour",type:"timeseries",tick:{count:12,format:"%H"}},y:{label:{text:"Degree (C)",position:"outer-middle"}}}},d={bindto:"#week",data:a.data,axis:{x:{type:"timeseries",tick:{count:12,format:"%d/%m %H"}},y:{label:{text:"Degree (C)",position:"outer-middle"}}}},e={bindto:"#month",data:a.data,axis:{x:{type:"timeseries",tick:{count:24,format:"%d/%m"}},y:{label:{text:"Degree (C)",position:"outer-middle"}}},tooltip:{format:{title:function(a){return g(a)}}}},f=d3.time.format("%H:%M"),g=d3.time.format("%d/%m %H");return{hour:b,today:c,week:d,month:e}}(),g=function(){var a=document.location.toString();a.match("#")&&$(".nav-tabs a[href=#"+a.split("#")[1]+"]").tab("show"),$(".nav-tabs a").on("shown",function(a){window.location.hash=a.target.hash})},h=function(a){for(var b=a.length-1;b>=0;b--)if(null!==a[b])return!1;return!0},i=function(a){for(var b=1;b<a.length;b++)if(!h(a[b]))return!1;return!0},j=function(a){return"http://"+c+":"+d+"@"+e+"/api/"+a},k=function(a,b,f){c=a,d=b,e=f},l=function(a,b){var c=new XMLHttpRequest;c.open("GET",a,!0),c.onreadystatechange=function(){4===c.readyState&&200===c.status&&b(c.responseText)},c.send()},m=function(){var a=c3.generate(f.today);l(j("graph/span/day"),function(b){var c=JSON.parse(b);RackTemp.isChartEmpty(c)?document.getElementById(f.today.bindto.substring(1)).innerHTML="No chart data":a.load({columns:c})})},n=function(){var a=f.hour,b=c3.generate(a);l(j("graph/span/hour"),function(c){var d=JSON.parse(c);RackTemp.isChartEmpty(d)?document.getElementById(a.bindto.substring(1)).innerHTML="No chart data":b.load({columns:d})})},o=function(){var a=f.week,b=c3.generate(a);l(j("graph/span/week"),function(c){var d=JSON.parse(c);RackTemp.isChartEmpty(d)?document.getElementById(a.bindto.substring(1)).innerHTML="No chart data":b.load({columns:d})})},p=function(){var a=f.month,b=c3.generate(a);l(j("graph/span/month"),function(c){var d=JSON.parse(c);RackTemp.isChartEmpty(d)?document.getElementById(a.bindto.substring(1)).innerHTML="No chart data":b.load({columns:d})})},q=[{host:"smtp.gmail.com",port:"465",encryption:1}],r=function(){var a=document.getElementById("smtp-presets"),b=document.getElementById("smtp-host"),c=document.getElementById("smtp-port"),d=document.getElementById("smtp-encryption"),e=document.getElementById("smtp-auth"),f=document.getElementById("smtp-user"),g=document.getElementById("smtp-password");a.onchange=function(){var e=a.options[a.selectedIndex].value;void 0!==q[e]&&(b.value=q[e].host,c.value=q[e].port,d.selectedIndex=q[e].encryption)},e.onclick=function(){e.checked?(f.disabled=!1,g.disabled=!1,f.required=!0,g.required=!0):(f.disabled=!0,g.disabled=!0,f.required=!1,g.required=!1)}};return{chart:f,clock:a,loadToTab:g,isChartEmpty:i,setApiInfo:k,createChartToday:m,createChartHour:n,createChartWeek:o,createChartMonth:p,smtpSettingsSetup:r}}();